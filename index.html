<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Black Hole Time Dilation Calculator</title>
<style>
body { font-family: sans-serif; background:#111; color:#fff; padding:20px; }
input, button { width:100%; padding:10px; margin-bottom:10px; border-radius:5px; border:none; }
button { background:#0a0; color:#fff; cursor:pointer; }
#output { background:#000; color:#0f0; padding:10px; border-radius:8px; white-space: pre-wrap; }
</style>
</head>
<body>
<h2>Black Hole Time Dilation Calculator</h2>

<label>Mass of Black Hole (kg):</label>
<input id="mass" type="number" step="any" placeholder="e.g. 5.97e24">

<label>Distance from Black Hole (km):</label>
<input id="distance" type="number" step="any" placeholder="e.g. 6000">

<label>Mode (0 = Faller’s time, 1 = Viewer’s time):</label>
<input id="mode" type="number" min="0" max="1" placeholder="0 or 1">

<label>Viewer’s Time (s, if mode=0):</label>
<input id="vtime" type="number" step="any" placeholder="e.g. 1000">

<label>Faller’s Time (s, if mode=1):</label>
<input id="ftime" type="number" step="any" placeholder="e.g. 1200">

<button onclick="calculate()">Calculate</button>

<div id="output">Output will appear here...</div>

<script>
const apis = [
  { type: 'json', url: 'https://hornbill9916.pythonanywhere.com/calculate' },
  { type: 'json', url: 'https://operationarmstrong-6.onrender.com/calculate' },
  { type: 'query', url: 'https://dce81952-ff2f-4e10-ba0d-737c2ea0a1fc-00-2fmx6293xzfgw.worf.replit.dev/blackhole' }
];

async function calculate() {
  const M = parseFloat(document.getElementById('mass').value);
  const r = parseFloat(document.getElementById('distance').value);
  const mode = parseInt(document.getElementById('mode').value);
  const vtime = parseFloat(document.getElementById('vtime').value);
  const ftime = parseFloat(document.getElementById('ftime').value);
  const timeValue = (mode === 0) ? vtime : ftime;

  document.getElementById('output').innerText = "Calculating...";

  for (let api of apis) {
    try {
      let response;
      if (api.type === 'json') {
        response = await fetch(api.url, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ mass: M, distance: r, mode: mode, time: timeValue })
        });
        if (!response.ok) throw new Error('Server returned ' + response.status);
        const result = await response.json();
        document.getElementById('output').innerHTML = `
          <strong>Schwarzschild radius:</strong> ${result.schwarzchild_radius} m<br>
          ${result.faller_time
            ? `<strong>Faller’s time:</strong> ${result.faller_time} s`
            : `<strong>Viewer’s time:</strong> ${result.viewer_time} s`}
          <br><em>Served by: ${api.url}</em>
        `;
        return;
      } else if (api.type === 'query') {
        // Replit API expects query parameters
        const url = `${api.url}?M=${encodeURIComponent(M)}&r=${encodeURIComponent(r)}&time=${encodeURIComponent(mode)}&viewerstime=${encodeURIComponent(vtime)}&fallerstime=${encodeURIComponent(ftime)}`;
        response = await fetch(url);
        if (!response.ok) throw new Error('Server returned ' + response.status);
        const text = await response.text();
        document.getElementById('output').innerHTML = `
          <pre>${text}</pre>
          <br><em>Served by: ${api.url}</em>
        `;
        return;
      }
    } catch (err) {
      console.warn(`API failed: ${api.url}`, err);
    }
  }

  document.getElementById('output').innerText = "❌ All APIs failed. Please try again later.";
}
</script>

</body>
</html>
