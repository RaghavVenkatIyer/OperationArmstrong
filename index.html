<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Black Hole Simulator</title>
<style>
  * { box-sizing: border-box; font-family: "Poppins", sans-serif; color: #fff; }
  body {
    margin: 0;
    overflow: hidden;
    background: radial-gradient(circle at center, #000010 0%, #000000 100%);
  }

  canvas#space {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: -1;
  }

  .container {
    position: relative;
    width: 90%;
    max-width: 600px;
    margin: 60px auto;
    background: rgba(0,0,0,0.7);
    padding: 30px;
    border-radius: 20px;
    box-shadow: 0 0 20px rgba(255,255,255,0.1);
  }

  h1 {
    text-align: center;
    font-size: 1.8em;
    margin-bottom: 20px;
  }

  label {
    display: block;
    margin: 12px 0 6px;
    font-size: 1em;
  }

  input, select {
    width: 100%;
    padding: 10px;
    border: none;
    border-radius: 6px;
    background: rgba(255,255,255,0.1);
    color: #fff;
    font-size: 1em;
  }

  button {
    width: 100%;
    padding: 12px;
    margin-top: 20px;
    border: none;
    border-radius: 10px;
    background: linear-gradient(90deg, #1a73e8, #000d8a);
    color: white;
    font-size: 1.1em;
    cursor: pointer;
    transition: background 0.3s;
  }

  button:hover {
    background: linear-gradient(90deg, #000d8a, #1a73e8);
  }

  pre#output {
    background: rgba(255,255,255,0.08);
    padding: 15px;
    margin-top: 25px;
    border-radius: 10px;
    white-space: pre-wrap;
    font-size: 0.95em;
  }
</style>
</head>
<body>
<canvas id="space"></canvas>

<div class="container">
  <h1>üåÄ Black Hole Simulator</h1>

  <label>Enter the mass of black hole (kilograms):</label>
  <input id="mass" type="number" step="any">

  <label>Enter the distance from center (meters):</label>
  <input id="distance" type="number" step="any">

  <label>Choose what you want to calculate:</label>
  <select id="timeChoice">
    <option value="viewer">Time for viewer outside the black hole</option>
    <option value="faller">Time for object falling in</option>
  </select>

  <label>Enter the time (seconds):</label>
  <input id="time" type="number" step="any">

  <label>Enter mass of the object (kilograms):</label>
  <input id="objectMass" type="number" step="any">

  <label>Enter height from which object falls (meters):</label>
  <input id="height" type="number" step="any">

  <button onclick="simulate()">Calculate</button>
  <pre id="output"></pre>
</div>

<script>
async function simulate() {
  const mass = parseFloat(document.getElementById("mass").value);
  const distance = parseFloat(document.getElementById("distance").value);
  const timeChoice = document.getElementById("timeChoice").value;
  const time = parseFloat(document.getElementById("time").value);
  const objectMass = parseFloat(document.getElementById("objectMass").value);
  const height = parseFloat(document.getElementById("height").value);
  const output = document.getElementById("output");

  output.textContent = "Calculating...\n";

  try {
    const res = await fetch("https://api-endpoint-shivvcharan2099.replit.app/blackhole", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ mass, distance, timeChoice, time, objectMass, height })
    });

    if (!res.ok) throw new Error("Server error");
    const data = await res.json();
    output.textContent = data.result || JSON.stringify(data, null, 2);
  } catch (e) {
    output.textContent += "\n‚ö†Ô∏è Could not connect to API. Running local fallback...\n";

    // --- Local fallback (matches Python logic) ---
    const G = 6.674e-11, c = 3e8;
    const schwarzschildRadius = (2 * G * mass) / (c ** 2);
    const gravity = (G * mass) / (distance ** 2);
    const timeDilation = 1 / Math.sqrt(1 - (2 * G * mass) / (distance * c ** 2));
    const potentialEnergy = objectMass * gravity * height;

    let result = "";
    result += `Schwarzschild radius: ${schwarzschildRadius.toExponential(3)} m\n`;
    result += `Gravitational acceleration: ${gravity.toExponential(3)} m/s¬≤\n`;
    result += `Time dilation factor: ${timeDilation.toFixed(6)}\n`;
    result += `Potential energy: ${potentialEnergy.toExponential(3)} J\n`;

    if (timeChoice === "viewer")
      result += `\nViewer time: ${time * timeDilation} s`;
    else
      result += `\nFaller time: ${time / timeDilation} s`;

    output.textContent = result;
  }
}

// Background black hole animation
const canvas = document.getElementById("space");
const ctx = canvas.getContext("2d");
let w, h;
function resize() { w = canvas.width = window.innerWidth; h = canvas.height = window.innerHeight; }
resize(); window.onresize = resize;

function drawBlackhole() {
  ctx.clearRect(0,0,w,h);
  const centerX = w/2, centerY = h/2;
  const gradient = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, 400);
  gradient.addColorStop(0, "#000000");
  gradient.addColorStop(0.3, "#0a0a40");
  gradient.addColorStop(0.6, "#000010");
  gradient.addColorStop(1, "transparent");
  ctx.fillStyle = gradient;
  ctx.beginPath();
  ctx.arc(centerX, centerY, 400, 0, Math.PI * 2);
  ctx.fill();

  // Event horizon glow
  ctx.beginPath();
  ctx.arc(centerX, centerY, 120, 0, Math.PI * 2);
  ctx.strokeStyle = "rgba(255,255,255,0.1)";
  ctx.lineWidth = 3;
  ctx.stroke();

  requestAnimationFrame(drawBlackhole);
}
drawBlackhole();
</script>
</body>
</html>
